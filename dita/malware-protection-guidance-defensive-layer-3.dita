<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="malware-protection-guidance-defensive-layer-3">
  <title>Malware Protection Guide: Defensive Layer 3</title>
  <topic id="introduction">
    <title>Introduction</title>
    <body>
      <p>This guide explains the types of controls that need to be implemented to form the third of three layers of defence. Layer 3 helps reduce the impact of malware infection in two ways:</p>
      <ul>
        <li>
          <p>reducing the ability for malware to move across networks</p>
        </li>
        <li>
          <p>ensuring that data is backed up</p>
        </li>
      </ul>
      <p>This guide is a sub-page to the <xref href="malware-protection-guide-introduction.dita" format="dita" type="topic">Malware Protection Guide</xref>.</p>
    </body>
    <topic id="who-is-this-for">
      <title>Who is this for?</title>
      <body>
        <p>This Malware Protection information is mainly intended for in-house <ph conref="conrefs.dita#conrefs/mojlong"/> Digital and Technology staff who are responsible for implementing controls throughout technical design, development, system integration and operation. This includes DevOps, Software Developers, Technical Architects, and Service Owners. It also includes Incident Managers from the Event, Problem, Incident, CSI and Knowledge (EPICK) Team.</p>
        <p>Other <ph conref="conrefs.dita#conrefs/moj"/> bodies, agencies, contractors, or IT suppliers and partners who in any way design, develop or supply services (including processing, transmitting and storing data) for, or on behalf of the <ph conref="conrefs.dita#conrefs/moj"/>, will also find this information helpful.</p>
      </body>
    </topic>
  </topic>
  <topic id="defensive-layer-3-resilience-and-rapid-response">
    <title>Defensive Layer 3: Resilience and Rapid Response</title>
    <body>
      <p>Even with the controls created by defensive layers 1 and 2, it is still possible that malware might reside and execute on the <ph conref="conrefs.dita#conrefs/moj"/> networks. The following controls can help to build resilience, ensure a rapid response to infection, and reduce the impact of a successful malware intrusion:</p>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <tbody>
            <row>
              <entry colname="col1">Do</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that applications, services or systems are segregated from the rest of the network as soon as they are no longer supported by the vendor or by <ph conref="conrefs.dita#conrefs/moj"/> teams. The NCSC provides guidance on how to implement <xref format="html" scope="external" href="https://www.ncsc.gov.uk/guidance/obsolete-platforms-security-guidance">segregation of unsupported platforms</xref>.</entry>
            </row>
            <row>
              <entry colname="col1">✔ If you are designing a system, ensure that it can make regular, reliable backups of data. This is to limit the amount of data corrupted, encrypted or lost if an application, service or system is infected with malware.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that backups meet all the criteria in <xref href="#defensive-layer-3-resilience-and-rapid-response/note-1" format="dita">Note 1</xref>. The <xref format="html" scope="external" href="https://www.ncsc.gov.uk/blog-post/offline-backups-in-an-online-world">NCSC</xref> provides further guidance on data backups stored in public cloud environments.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Make sure that user permissions are regularly reviewed. Access to systems or drives no longer required by users must be removed. This is especially important for administrator accounts. See the <xref href="access-control-guide.dita" format="dita" type="topic">Access Control Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ When managing a system, ensure that backups are conducted in line with the system requirements outlined in the IRAR.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Prioritise patches and updates of devices that perform security-related functions on the <ph conref="conrefs.dita#conrefs/moj"/> network. This includes firewalls and any device on the network boundary. See the <xref href="vulnerability-scanning.dita" format="dita" type="topic">Vulnerability Scanning and Patch Management Guide</xref> for further details.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Conduct regular audits of the software and data held on systems which support critical business processes. Check if they have been modified by malicious code.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Isolate critical <ph conref="conrefs.dita#conrefs/moj"/> environments from the wider network as much as possible. This is to avoid significant business impact that might occur if the wider network is compromised by malware.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Don't</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✖ Use the same browser to conduct administrative activities that you use for general user activities. An example admin activity is changing access privileges. An example general user activity is searching the internet. Separating browsers for different activities can reduce the impact of malware attacks.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Delay implementing security patches on infrastructure. See the <xref href="vulnerability-scanning.dita" format="dita" type="topic">Vulnerability Scanning and Patch Management Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Delay if you suspect a malware incident has occurred. Make sure you contact the <xref href="#contact-details" format="dita">Technology Service Desk</xref> immediately.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    <section id="note-1">
      <title>Note 1</title>
      <note type="important">Ensure that backups:<ul><li>can be recovered. Some cloud providers allow data restoration from a point in time. This can be helpful if malware affects the cloud backup.</li><li>have an offline copy held in a separate location to the primary data storage. These are called cold backups and should be unaffected if an incident affects the primary environment</li><li>are updated and tested regularly. The regularity of backups should be outlined in the system's Information Risk Assessment Report (IRAR), which is normally completed by Security Architects and Risk Assessors, in conversation with the system architects, designers and developers. The IRAR document must also be agreed with the Business Continuity Team. For more information regarding IRARs, and how to create and maintain them, contact the <xref format="dita" href="#contact-details">Cyber Assistance Team</xref>.</li></ul></note>
    </section>
    </body>
  </topic>
  <topic id="preventing-and-detecting-lateral-movement">
    <title>Preventing and Detecting Lateral Movement</title>
    <body>
      <p>One of the most important ways of limiting the spread of malware on the network is to reduce lateral movement. This is where a malware problem 'jumps across' from system to system. The main ways to prevent lateral movement are covered in the tables below.</p>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Do</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✔ Make sure user credentials are protected. Do this using strong passwords which are stored securely. See the <xref href="password-managers.dita" type="topic" format="dita">Password Manager Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that effective access controls are designed and implemented in <ph conref="conrefs.dita#conrefs/moj"/> systems. Use <xref href="multi-factor-authentication-mfa-guide.dita" type="topic" format="dita">Multi-Factor Authentication (MFA)</xref> wherever possible. See the <xref href="access-control-guide.dita" format="dita" type="topic">Access Control Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Make sure you protect highly privileged accounts, by applying the principle of least privilege. See the <xref href="access-control-guide.dita" type="topic" format="dita">Access Control Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that any system or application running on the <ph conref="conrefs.dita#conrefs/moj"/>'s networks can collect and share system logs with the Operational Security Team's (OST) central monitoring function. This allows the <ph conref="conrefs.dita#conrefs/moj"/> to detect lateral movement by malware.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use tools for monitoring account activity, and look for indicators of account compromise. Examples include using <xref href="https://en.wikipedia.org/wiki/Conditional_access" format="html" scope="external">Conditional Access</xref> to manage access to the network, and detecting impossible geographical travel scenarios. Configure the tools to respond promptly by raising security alerts and so helping prevent a breach.</entry>
            </row>
            <row>
              <entry colname="col1">✔ In the exceptional circumstances where Bring your Own Device (BYOD) is permitted to access <ph conref="conrefs.dita#conrefs/moj"/> information, make sure your device runs anti-malware software and follows the requirements in <ph audience="audience-basic audience-tech"><xref href="personal-devices.dita" format="dita" type="topic">BYOD</xref></ph><ph audience="audience-suppliers">applicable BYOD</ph> guidance. Also ensure that users can only access <ph conref="conrefs.dita#conrefs/moj"/> emails through approved applications.</entry>
            </row>
            <row>
              <entry colname="col1">✔ If you are designing or modifying networks, ensure there is network segregation for systems and data that do not need to interact. This segregation can be achieved using physical or logical separation. Access between network domains is allowed, but must be controlled at the perimeter using a gateway such as a firewall.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Don't</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✖ Access emails through third party applications which have not been approved by the <ph conref="conrefs.dita#conrefs/moj"/>.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Allow access to information on devices, by default. Restrict access on devices to need to know.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Use your administrator account for any non-administrative functions. Access should only be elevated for the specific tasks required, and only while the task is performed. See the Privileged User guidance for further details.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <p>The NCSC provides helpful guidance on preventing <xref href="https://www.ncsc.gov.uk/guidance/preventing-lateral-movement" format="html" scope="external">lateral movement</xref> across networks.</p>
    </body>
  </topic>
  <topic id="contact-details" conref="malware-protection-guide-introduction.dita#contact-details"><title/></topic>
  <topic id="feedback" conref="conrefs.dita#feedback"><title/></topic>
</topic>
