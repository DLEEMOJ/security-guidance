<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="malware-protection-guidance-defensive-layer-2">
  <title>Malware Protection Guide: Defensive Layer 2</title>
  <topic id="introduction">
    <title>Introduction</title>
    <body>
      <p>This guide explains the types of controls that need to be implemented to form the second of three layers of defence. This guide is a sub-page to the <xref href="malware-protection-guide-introduction.dita" format="dita" type="topic">Malware Protection Guide</xref>.</p>
    </body>
    <topic id="who-is-this-for">
      <title>Who is this for?</title>
      <body>
        <p>This Malware Protection information is mainly intended for in-house <ph conref="conrefs.dita#conrefs/mojlong"/> Digital and Technology staff who are responsible for implementing controls throughout technical design, development, system integration and operation. This includes DevOps, Software Developers, Technical Architects, and Service Owners. It also includes Incident Managers from the Event, Problem, Incident, CSI and Knowledge (EPICK) Team.</p>
        <p>Other <ph conref="conrefs.dita#conrefs/moj"/> bodies, agencies, contractors, or IT suppliers and partners who in any way design, develop or supply services (including processing, transmitting and storing data) for, or on behalf of the <ph conref="conrefs.dita#conrefs/moj"/>, will also find this information helpful.</p>
      </body>
    </topic>
  </topic>
  <topic id="defensive-layer-2-preventing-malicious-code-from-being-executed">
    <title>Defensive Layer 2: Preventing malicious code from being executed</title>
    <body>
      <p>Layer 1 might not always prevent malware from reaching the network. Assume that malware can and will reach <ph conref="conrefs.dita#conrefs/moj"/> devices at some point. The next layer of protection prevents malicious code from taking effect. The tables below outlines ways in which you can help prevent malicious code from executing.</p>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <tbody>
            <row>
              <entry colname="col1">Do</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that all systems and endpoints are scanned by anti-malware software. See <xref href="#defensive-layer-2-preventing-malicious-code-from-being-executed/note-1" format="dita">Note 1</xref> for more details.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that if you are developing a new Microsoft Windows based system, that the <ph conref="conrefs.dita#conrefs/moj"/>'s Windows Defender enterprise anti-malware software for Microsoft environments is configured to regularly scan it. Contact the OST for further information on how to do this.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that if you require additional anti-malware scanning functionality because of a higher malware risk, or you have non-Microsoft Windows systems, then other anti-malware vendors can be considered. You must discuss your selection with the <xref format="dita" href="#contact-details">Cyber Assistance Team</xref> and the <xref format="html" href="#contact-details">Operational Security Team (OST)</xref>. See <xref href="#defensive-layer-2-preventing-malicious-code-from-being-executed/note-2" format="dita">Note 2</xref> for more details.</entry>
            </row>
            <row>
              <entry colname="col1">✔ If you are designing or developing a system which you expect to be at high risk of malware, you should ensure it is built with sandboxing capability in order to minimise the impact of malicious code executing on endpoints.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use hardened devices including approved and assured Gold Builds. Further information can be found in the Technical Controls guide. Contact the <xref format="html" href="#contact-details">Cyber Assistance Team</xref> for more information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ If you are developing or modifying networks, you should consider what protective monitoring is required. Contact the <xref format="dita" href="#contact-details">OST</xref> for details. Protective monitoring required can include Intrusion Prevention Systems (IPS) &amp; Intrusion Detection Systems (IDS) to monitor, alert and block suspicious activity. These systems should feed monitoring data to the <ph conref="conrefs.dita#conrefs/moj"/> OST's central monitoring capability.</entry>
            </row>
            <row>
              <entry colname="col1">✔ When developing new systems and services, or updating or maintaining them, ensure that you refer to the security requirements detailed in the <ph conref="conrefs.dita#conrefs/moj"/> Software Development Lifecycle (SDLC) guidance. Contact the <xref format="dita" href="#contact-details">Cyber Assistance Team</xref> for more information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure production environments are segregated from other systems. Prior to going live, ensure this environment is assessed against the relevant top 20 <xref format="html" scope="external" href="https://www.cisecurity.org/cybersecurity-best-practices">Center for Internet Security Controls</xref>.</entry>
            </row>
            <row>
              <entry colname="col1">✔ If you are configuring host-based or network firewalls, ensure inbound connections are configured as <codeph>deny by default</codeph>. Outbound connections should also be denied by default on network devices such as firewalls, to prevent viruses avoiding proxies when leaving the <ph conref="conrefs.dita#conrefs/moj"/>'s systems. You should review these rules at least once every three months, to ensure they allow only necessary traffic.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that all systems have agreed maintenance windows for patching. These maintenance windows must meet the Service Level Agreement timescales outlined in the <xref href="vulnerability-scanning.dita" format="dita" type="topic">Vulnerability Scanning and Patch Management Guide</xref>.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Where possible, you should enable automatic updates for operating systems, applications, and firmware.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use versions of operating systems and applications which receive wide general support. This means they can take advantage of up-to-date security features, and so reduce vulnerabilities.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use automated code scanning services to help identify malicious and vulnerable code, including for open source applications or services. See the Secure Development Lifecycle guidance for further information.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Don't</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✖ Enable macros if you are using productivity suites unless there is an approved business case for doing so. For help on this point, contact the <xref href="#contact-details" format="html">Cyber Assistance Team</xref>. Macros should be disabled by default.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Design systems to use multiple consecutive firewalls for systems processing <codeph>OFFICIAL</codeph> information. The exception is where the firewalls act as a contract enforcement point between two entities that are connecting to each other. In this case, the firewalls are structural devices that help define the boundary of responsibility rather than providing security. See the <xref href="https://www.ncsc.gov.uk/whitepaper/security-architecture-anti-patterns#section_5" format="html" scope="external">NCSC guidance</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Delay implementing security patches on infrastructure when possible. See the <xref href="vulnerability-scanning.dita" format="dita" type="topic">Vulnerability Scanning and Patch Management Guide</xref> for further information.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <section id="note-1">
        <title>Note 1</title>
        <note type="important">Those who manage anti-malware software must ensure that:<ul><li>it is in a working state</li><li>it is set to receive updates at the highest possible frequency</li><li>it is updated automatically with the latest virus definitions and updates</li><li>scans are scheduled regularly or as external devices are added</li><li>any findings are reviewed, and</li><li>any anti-malware alerts are reported to the <xref format="dita" href="#contact-details">Technology Service Desk</xref> and the <xref format="dita" href="#contact-details">Operational Security Team (OST)</xref>.</li></ul></note>
      </section>
      <section id="note-2">
        <title>Note 2</title>
        <note type="important">Anti-malware tools must:<ul><li>scan at least daily</li><li>provide regular software updates</li><li>have a Self-Protect Mode enabled</li><li>have Clean/Quarantine capabilities</li><li>provide regular reports and alerting to administrators</li><li>prevent anti-malware services from being shut down without authorisation</li><li>have defined responsibilities for maintaining, updating and reviewing the solution</li><li>have defined test response and recovery plans to outbreaks</li></ul></note>
      </section>
    </body>
  </topic>
  <topic id="contact-details" conref="malware-protection-guide-introduction.dita#contact-details"><title/></topic>
  <topic id="feedback" conref="conrefs.dita#feedback"><title/></topic>
</topic>
