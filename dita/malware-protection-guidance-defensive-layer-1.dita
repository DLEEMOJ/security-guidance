<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="malware-protection-guidance-defensive-layer-1">
  <title>Malware Protection Guide: Defensive Layer 1</title>
  <topic id="introduction">
    <title>Introduction</title>
    <body>
      <p>This guide explains the types of controls that need to be implemented to form the first of three layers of defence. Layer 1 reduces the likelihood that malicious content will reach the <ph conref="conrefs.dita#conrefs/mojlong"/> network through implementing the controls outlined in this guide. This guide is a sub-page to the <xref href="malware-protection-guide-introduction.dita" format="dita" type="topic">Malware Protection Guide</xref>.</p>
    </body>
    <topic id="who-is-this-for">
      <title>Who is this for?</title>
      <body>
        <p>This Malware Protection information is mainly intended for in-house <ph conref="conrefs.dita#conrefs/moj"/> Digital and Technology staff who are responsible for implementing controls throughout technical design, development, system integration and operation. This includes DevOps, Software Developers, Technical Architects, and Service Owners. It also includes Incident Managers from the Event, Problem, Incident, CSI and Knowledge (EPICK) Team.</p>
        <p>Other <ph conref="conrefs.dita#conrefs/moj"/> bodies, agencies, contractors, or IT suppliers and partners who in any way design, develop or supply services (including processing, transmitting and storing data) for, or on behalf of the <ph conref="conrefs.dita#conrefs/moj"/>, will also find this information helpful.</p>
      </body>
    </topic>
  </topic>
  <topic id="defensive-layer-1-preventing-malicious-code-from-being-delivered-to-devices">
    <title>Defensive Layer 1: Preventing malicious code from being delivered to devices</title>
    <body>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Do</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✔ Ensure that all public facing URLs that are assigned to services owned or managed on behalf of the <ph conref="conrefs.dita#conrefs/moj"/> are protected by enrolling them in the <xref href="https://www.ncsc.gov.uk/information/web-check" format="html" scope="external">NCSC Web Check</xref> service. Contact <xref href="mailto:security@justice.gov.uk" format="email" scope="external">security@justice.gov.uk</xref> to add URLs to this service.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use of the <xref href="public-sector-dns.dita" format="dita">Protective Domain Naming Service subscription</xref> service should be configured for end users. As a Central Government department, systems owned or managed on behalf of the <ph conref="conrefs.dita#conrefs/moj"/> are permitted to use the service for free. Contact <xref href="mailto:security@justice.gov.uk" format="email" scope="external">security@justice.gov.uk</xref> to be included in this service.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that if you are developing a system or application where any element is outsourced, such as hosting a service in the cloud, you must understand and record security related responsibilities of the <ph conref="conrefs.dita#conrefs/moj"/>, of the cloud service provider and any other supplier. For guidance on what responsibilities to consider, see the <xref href="https://www.ncsc.gov.uk/collection/cloud-security" format="html" scope="external">NCSC guidance on Cloud Security</xref> or <xref href="https://www.iso.org/standard/43757.html" format="html" scope="external">ISO27017</xref>. These provide guidelines for information security controls applicable to the provision and use of cloud services.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that if you are managing an email system, all inbound emails to the <ph conref="conrefs.dita#conrefs/moj"/> are scanned for malware. For Microsoft systems this is provided by Office 365 which quarantines any suspected malware.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Avoid the need for removable media by using existing approved online collaboration services where possible, for example Office 365. Where removable media has to be used, it must be scanned by approved Anti-virus before and during use.</entry>
            </row>
            <row>
              <entry colname="col1">✔ All web traffic must be routed through a proxy which logs and monitors internet access. This reduces the chance of malicious sites infecting end user devices. The proxy is configured in agreement with the security team. Email must also be routed through email scanning services. Direct Internet access should only be configured for update services, and by exception only.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Allow the installation of applications only from approved stores.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Systems must be able to be updated and must be kept up-to-date with OS and application upgrades and patches. Where possible, software updates should be configured to update automatically. See the <xref href="vulnerability-scanning.dita" format="dita">Vulnerability Scanning and Patch Management Guide</xref> for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ A formal process must be developed and documented to ensure all firewall configuration changes are approved before being implemented.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Be aware of the risks of '<xref href="https://en.wikipedia.org/wiki/Watering_hole_attack" format="html" scope="external">watering hole attacks</xref>' that use GitHub or other open source code repositories. These attacks place malware into popular sites. Avoid trusting code, components, or other resources from popular sites. See the Access Control Guide for further information.</entry>
            </row>
            <row>
              <entry colname="col1">✔ When developing a new system. ensure that it's properly scoped to understand what, if any, appropriate anti-malware software is required. You must also ensure that if the eventual system has anti-malware software, that it is configured to minimise the impact of scans on system or application performance. Contact the <xref href="#contact-details" format="html">Operational Security Team (OST)</xref> for further information on how to do this.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Ensure that if you are responsible for patching or installing security updates of an in-house developed system or application follow the processes and requirements set out in the <xref href="vulnerability-scanning.dita" format="dita">Vulnerability Scanning and Patch Management Guide</xref>. The success of these updates should be validated using automated vulnerability scanning services.</entry>
            </row>
            <row>
              <entry colname="col1">✔ Use hardened devices including approved and assured Gold Builds. Further information can be found in the Technical Controls guidance; contact the <xref href="#contact-details" format="html">Cyber Assistance Team</xref> for help with this.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table>
        <tgroup cols="1">
          <colspec colname="col1" colnum="1" colwidth="1*"/>
          <thead>
            <row>
              <entry colname="col1">Don't</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">✖ Allow externally obtained (from outside the <ph conref="conrefs.dita#conrefs/moj"/>) executable software to run. This includes auto-running macros.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Try to circumvent any security controls such as safe browsing lists or removable media controls; they are in place to protect the <ph conref="conrefs.dita#conrefs/moj"/> from malware.</entry>
            </row>
            <row>
              <entry colname="col1">✖ Connect any devices not procured and/or managed by the <ph conref="conrefs.dita#conrefs/moj"/> to trusted networks. Devices connected to <ph conref="conrefs.dita#conrefs/moj"/> trusted networks must be under <ph conref="conrefs.dita#conrefs/moj"/> management.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </body>
  </topic>
  <topic id="contact-details" conref="malware-protection-guide-introduction.dita#contact-details"><title/></topic>
  <topic id="feedback" conref="conrefs.dita#feedback"><title/></topic>
</topic>
