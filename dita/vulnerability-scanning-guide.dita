<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="vulnerability-scanning-guide">
  <title>Vulnerability Scanning Guide</title>
  <topic id="introduction">
    <title>Introduction</title>
    <body>
      <p>This guide explains the scanning requirements
        for <ph conref="conrefs.dita#conrefs/mojlong"/> systems.</p>
      <p>This guide is a sub-page to the <xref href="vulnerability-scanning-and-patch-management-guide.dita" format="dita">Vulnerability
        Scanning and Patch Management Guide</xref>.</p>
    </body>
  </topic>
  <topic id="scanning-requirements">
    <title>Scanning requirements</title>
    <body>
      <p>The <ph conref="conrefs.dita#conrefs/moj"/> should conduct the following scanning activities outlined in this guidance
        and in line with the requirements identified in this guide.
      <ul>
        <li>If you are developing a system or application,
          you must ensure that they are scanned for vulnerabilities
          prior to live deployment and as part of approval for live deployment.</li>
        <li>If you are managing a live service,
          you must ensure that the system or application is scanned at specified intervals
          after deployment until it is withdrawn from service.</li>
        <li>The scanning frequency section in this guide gives the minimum scanning requirement,
          however the system or application itself may need to be scanned more frequently.
          Any specific scanning frequencies or requirements will be outlined in the system
          or application Information Risk Assessment Report (IRAR).
          <p conref="conrefs.dita#conrefs/irardefinition"/></li>
        <li>Scanning must be conducted through automated vulnerability scanning tools that scan web applications,
          from inside or outside the system,
          to look for security vulnerabilities.</li>
        <li>The scanning process should consider the licensing and support status for an infrastructure device,
          its operating system, or any applications hosted on the device.</li>
        <li>Scans which take place one year before the expiry of a license or vendor support
          should flag the forthcoming expiry as requiring attention and remediation
          such as license renewal or equipment replacement.</li>
        <li>Examples of known vulnerabilities which must be scanned for include cross-site scripting (XSS),
          SQL injection, command injection, path traversal, and insecure server configuration.</li>
        <li>If scans identify vulnerabilities,
          patches must be applied according to the schedule described in
          the <xref href="patch-management-guide.dita" format="dita">Patch Management guide</xref>.</li>
      </ul></p>
      <p>For assistance with identifying,
        evaluating,
        and selecting appropriate tooling for scanning,
        contact the <xref href="#contact-details" format="dita">Security Team</xref>.</p>
        <!--
        <li>There are many options for scanning tools including open source or commercially available scanning tools.
          The Open Web Application Security Project (OWASP) provides
          <xref href="https://owasp.org/www-community/Vulnerability_Scanning_Tools" format="html" scope="external">analysis</xref>
          of each of these tools' strengths and weaknesses.</li>
        <li>The top 10 application issues from the <xref href="https://owasp.org/www-project-top-ten/" format="html" scope="external">OWASP</xref>
          and the CWE/SANS TOP 25 Most Dangerous Software Errors from
          <xref href="https://www.sans.org/top25-software-errors" format="html" scope="external">SANS</xref> are
          two valuable sources of information about common vulnerabilities which should be scanned for.</li> -->
        <note>Expired or missing license or support materials for a system or service are also considered to be vulnerabilities.
          The reason is simple - using a system or service without the necessary license might result in financial or reputational loss.
          Similarly,
          using a system or service without the necessary support in place might result in loss of availability,
          performance, integrity, confidentiality, or other problems.</note>
    </body>
  </topic>
  <topic id="point-in-time-scanning">
    <title>Point in time scanning</title>
    <body>
      <p>By default,
        all applications and services should be scanned automatically,
        on a <xref href="#scanning-frequency" format="dita">regular basis</xref>.
        However,
        there will be occasions where extra,
        'Point in time' vulnerability scans are required. 
        These provide an assessment of the vulnerabilities at that point in time.</p>
      <p>An example might be following a significant configuration change or application update,
        and it is considered advisable to check for vulnerabilities at that point in time,
        rather than waiting until the next, scheduled check.</p>
    </body>
  </topic>
  <topic id="web-check">
    <title>Web Check</title>
    <body>
      <p>In addition to specific scanning processes,
        the NCSC's Web Check services must be employed for all open internet facing websites
        operated by the <ph conref="conrefs.dita#conrefs/moj"/>.
        Web Check continuously scans these websites
        and provides regular reports to the <ph conref="conrefs.dita#conrefs/securityemailtext"/>.
        If you are responsible for developing or running a website for the <ph conref="conrefs.dita#conrefs/moj"/>,
        you must:
        <ul>
          <li>Ensure that it is added to the <ph conref="conrefs.dita#conrefs/moj"/> HQ Web Check Account.
            <xref href="#contact-details" format="dita">Contact</xref> the <ph conref="conrefs.dita#conrefs/moj"/> Security
            team to be added to the <ph conref="conrefs.dita#conrefs/moj"/> Web Check Account.</li>
          <li>Ensure that any vulnerabilities identified are patched according to the Patching Schedule
            in the <xref href="patch-management-guide.dita" format="dita">Patch Management guide</xref>.</li>
        </ul></p>
      <p>Further information on the NCSC's Web Check service can be found <xref href="web-check.dita" format="dita">here</xref>.</p>
    </body>
  </topic>
  <topic id="scanning-frequency">
    <title>Scanning frequency</title>
    <body>
      <p>Scanning should be undertaken in line with the following indicative schedule for each system and equipment type.
        <table>
          <tgroup cols="2">
            <colspec colname="col1" colnum="1"/>
            <colspec colname="col2" colnum="2"/>
            <thead>
              <row>
                <entry>System and equipment type</entry>
                <entry>Minimum scanning frequency</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>Internet Facing Websites and Digital Services</entry>
                <entry>Every week.</entry>
              </row>
              <row>
                <entry>Infrastructure Devices</entry>
                <entry>Every week.</entry>
              </row>
              <row>
                <entry>Server Applications</entry>
                <entry>Every week.</entry>
              </row>
              <row>
                <entry>End User Clients</entry>
                <entry>Every two weeks.</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
      <p>The actual minimum scanning frequency for a given service or system
        might be determined by a separate Service Level Agreement,
        contract, IRAR or other formal agreement.
        If there is a conflict with the Scanning Frequency defined in this guide,
        the contract, IRAR or other formal agreement takes precedence over this guide.</p>
      <p>You need to ensure that scanning logs and results are made available to
        the <ph conref="conrefs.dita#conrefs/moj"/> Security Team (<ph conref="conrefs.dita#conrefs/securityemail"/>)
        for subsequent analysis and potentially forensic investigation purposes.</p>
    </body>
  </topic>
  <topic id="vulnerability-alerts">
    <title>Vulnerability alerts</title>
    <body>
      <p> Any problems picked up during scanning must be recorded and reported as a vulnerability alert.
        As a minimum,
        the alert should be reported to:
        <ul>
          <li>The system owner.</li>
          <li>The person responsible for risks regarding the system.</li>
          <li>The person responsible for risks regarding the information accessed or processed using the system.</li>
          <li>The <xref href="#contact-details" format="dita">Security Team</xref>.</li>
        </ul>
      </p>
      <p>These vulnerability alerts must contain as a minimum:
      <ul>
        <li>An alert identifier.</li>
        <li>A cross-reference to known vulnerabilities.</li>
        <li>A risk rating (refer to the following <xref href="#vulnerability-risk-ratings" format="dita">Vulnerability risk ratings</xref> section).</li>
        <li>A description of the fix, mitigation, or workaround, where known.</li>
        <li>A link to patch materials, if available.</li>
        <li>A status which is updated as necessary.</li>
        <li>Where to get further information.</li>
      </ul></p>
    </body>
  </topic>
  <topic id="vulnerability-risk-ratings">
    <title>Vulnerability risk ratings</title>
    <body>
      <p>Vulnerabilities are designated a severity rating (1-4) based on the level of risk they pose to the <ph conref="conrefs.dita#conrefs/moj"/>.
        The schedules defined in the <xref href="patch-management-guide.dita" format="dita">Patch Management Guide</xref>
        for remediation are aligned with the risk exposure the vulnerabilities create to systems.
        The vulnerability ratings are based on the Common Vulnerability Scoring System (CVSS)
        which is aligned with the Cyber Essentials Scheme. The MoJ uses CVSS version 3.
        If vendors use different terminology to define Critical or High Risk vulnerabilities,
        the following table should be used to define the CVSS score of the vulnerability:
        <table>
          <tgroup cols="3">
            <colspec colname="col1" colnum="1"/>
            <colspec colname="col2" colnum="2"/>
            <colspec colname="col3" colnum="3"/>
            <thead>
              <row>
                <entry>Rating (Severity)</entry>
                <entry>Values on CVSS</entry>
                <entry>Definition</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>Critical (4)</entry>
                <entry>9.0 - 10.0</entry>
                <entry>High, with compounding issues or additional circumstances.
                  An issue that will cause extreme financial or reputational damage.</entry>
              </row>
              <row>
                <entry>High Risk (3)</entry>
                <entry>7.0 - 8.9</entry>
                <entry>A serious issue that is likely to cause severe financial or reputational damage.</entry>
              </row>
              <row>
                <entry>Medium (2)</entry>
                <entry>4.0-6.9</entry>
                <entry>A significant issue that may cause financial or reputational damage.</entry>
              </row>
              <row>
                <entry>Low (1)</entry>
                <entry>0.0 - 3.9</entry>
                <entry>An issue that is unlikely to cause financial or reputational damage.</entry>
              </row>
              <row>
                <entry>Info</entry>
                <entry>N/A</entry>
                <entry>An issue with no immediate security implications.</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
    </body>
  </topic>
  <topic id="roles-and-responsibilities">
    <title>Roles and responsibilities</title>
    <topic id="managed-service">
      <title>Managed service</title>
      <body>
        <p>If you are responsible for a system or a service which is managed by a vendor,
          or a Managed Service Provider,
          the vendor may be responsible for scanning and alerting you of any vulnerabilities and providing patches.
          Please refer to the <xref href="patch-management-guide.dita" format="dita">Patch Management Guide</xref> for more information.
          The specific responsibilities will depend upon the services provided by the vendor
          and any contractual agreements between the <ph conref="conrefs.dita#conrefs/moj"/> and the vendor.</p>
        <p>The schedules for vendors to conduct vulnerability scanning and issue vulnerability alerts
          to the <ph conref="conrefs.dita#conrefs/moj"/> are outlined in this guidance.</p>
        <ul>
          <li>Scanning after Scheduled Patch Releases: Scan to take place within two business days
            from the implementation of the patch as required by the Patching Schedule Service Level Agreement
            in the <xref href="patch-management-guide.dita" format="dita">Patch Management Guide</xref>.
            The <ph conref="conrefs.dita#conrefs/moj"/> must be alerted of any vulnerabilities
            within 1 business day of the scan being conducted.</li>
          <li>Scanning after Ad Hoc / Off Cycle Patch Release: Scan to take place
            within three business days from the implementation of the patch as
            required by the Patching Service Level Agreement in the
            <xref href="patch-management-guide.dita" format="dita">Patch Management Guide</xref>.
            The <ph conref="conrefs.dita#conrefs/moj"/> must be alerted of any vulnerabilities within 1 business day of the scan being conducted.</li>
        </ul>
        <p>The actual scanning schedule for a given managed service or system may be
          determined by a separate Service Level Agreement, contract, IRAR, or other formal agreement.
          If there is a conflict with the requirements in this guide,
          the contract, IRAR or other formal agreement takes precedence over this guide.</p>
      </body>
    </topic>
    <topic id="in-house-developed">
      <title>In-house developed</title>
      <body>
        <p>If you are developing or running a system or application in-house,
          you must make sure that it is scanned.
          Where centralised scanning is not possible,
          the system owner is responsible for ensuring that scans are undertaken
          with at least the frequency defined in this document
          and in sufficient depth to identify vulnerabilities in libraries,
          code or infrastructure configuration.</p>
      </body>
    </topic>
  </topic>
  <!--
  <topic id="vulnerability-disclosure-policy">
    <title>Vulnerability disclosure policy</title>
    <body>
      <p>If you discover vulnerabilities outside of formal scanning,
        please read the <xref href="vulnerability-disclosure-policy.dita" format="dita">Vulnerability Disclosure Policy</xref>
        and report the vulnerability within the indicated timescale.</p>
    </body>
  </topic>
  -->
  <topic id="contact-details">
    <title>Contact and Feedback</title>
    <body>
      <p>Contact the Security Team for advice on risk, scanning
          and patching, to report a vulnerability alert,
          or to add a URL to
          the <ph conref="conrefs.dita#conrefs/moj"/> Web Check system: 
          <ph conref="conrefs.dita#conrefs/securityemail"/>.</p>
    </body>
  </topic>
  
</topic>
