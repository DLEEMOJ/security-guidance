---
Review: 2020-12-31
Owner: CISO
Target audience:
---

# Malware Protection Guide: Defensive Layer 2

## Introduction

This guide explains the types of controls that need to be implemented to form the second of three layers of defence. This guide is a sub-page to the Malware Protection Guide.

## Defensive Layer 2: Preventing malicious code from being executed

Layer 1 may not always prevent malware from reaching the network, so it should be assumed that malware can and will reach MoJ devices at some point. The tables below outlines how you can help prevent malicious code from executing.

| Do |
|--- |
| ✔ Ensure that all systems and endpoints are scanned by anti-malware software. Those who manage anti-malware software must ensure that:
| - it is in a working state  
| - it is updated automatically with the latest virus definitions and updates    
| - scans are scheduled regularly or as external devices are added, and any findings are reviewed, and
| - any anti-malware alerts (including false positives) are reported to the technology Service Desk and the Operational Security Team (OST). |
| ✔ Ensure that if you are developing a new Microsoft Windows based system, that the MoJ’s Windows Defender enterprise anti-malware software for Microsoft environments is configured to regularly scan it. Contact the OST for further information on how to do this. |
| ✔ Ensure that if you require additional anti-malware scanning functionality because of a higher malware risk, or you have non-Microsoft Windows systems, then other anti-malware vendors can be considered. They must:
| - scan at least daily|
| - provide regular software updates |
| - have a Self-Protect Mode enabled
| - have Clean/Quarantine capabilities
| - provide regular reports and alerting to administrators
| - prevent anti-malware services from being shut down without authorisation
| - have defined responsibilities for maintaining, updating and reviewing the solution
| - have defined test response and recovery plans to outbreaks
| - be approved by the NCSC Commercial Product Assurance (CPA)
| - be considered reputable by NCSC for UK Government systems e.g. NCSC advises against the use of Kaspersky, and
| - Not be wholly owned or operated from Russia, or other high Cyber Risk Countries.
| ✔ If you are designing or developing a system which you expect to be at high risk of malware, you should ensure it is built with sandboxing capability in order to minimise the impact of malicious code executing on endpoints. The OST can then transfer suspected malicious code to the MoJ CISCO sandbox for further analysis. |
| ✔ Use hardened devices including approved and assured Gold Builds. Further information can be found in the Technical Controls guide. |
| ✔  If you are developing / modifying networks, you should consider what protective monitoring is required. Contact the OST for details. Protective monitoring required can include Intrusion Prevention Systems (IPS) & Intrusion Detection Systems (IDS) to monitor, alert and block suspicious activity.  These systems should feed monitoring data to the MoJ OST’s central monitoring capability. |
|✔ Ensure any new services and systems are developed within a proper development environment which is segregated from the main MoJ networks. Furthermore, prior to development commencing, ensure this environment is assessed against Cyber Essentials. |
| Ensure production environments are segregated from other systems.  Prior to going live, ensure this environment is assessed against the relevant top 20 [Center for Internet Security Controls](https://www.cisecurity.org/cybersecurity-best-practices). |
| ✔ If you are configuring host-based or network firewalls, ensure inbound connections are configured as deny by default. Outbound connections should also be denied by default to prevent viruses avoiding proxies when leaving the MoJ’s systems. You should review these rules on a quarterly basis to ensure they allow only necessary traffic.|
| ✔ Ensure that all systems have agreed maintenance windows for patching which meet the Service Level Agreement timescales outlined in the Vulnerability Scanning and Patch Management guide. |
| ✔ Where possible, you should enable automatic updates for operating systems, applications, and firmware. |
| ✔ Use versions of operating systems and applications which receive wide general support. This means they can take advantage of up to date security features and reduce vulnerabilities. |
|✔ Use automated code scanning services to identify malicious and vulnerable code if it is open source such as GitHub. See the Secure Development Lifecycle guide for further information. |

| Don't |
|---|
| ✖ Enable macros if you are using productivity suites unless there is a business case for doing so. Macros are disabled by default. |
| ✖ Design systems to use multiple consecutive firewalls for systems processing OFFICIAL information. The exception is to act as a contract enforcement point between two entities that are connecting to each other, helping to denote the boundary of responsibility. See the [NCSC guidance](https://www.ncsc.gov.uk/whitepaper/security-architecture-anti-patterns#section_5) for further information.  |
| ✖ Delay implementing security patches on infrastructure when possible. See the Vulnerability Scanning and Patch Management guide for further information. |


## Contact details

* Contact the Cyber Assistance Team for advice on protecting against malware – [CyberConsultancy@digital.justice.gov.uk](mailto:CyberConsultancy@digital.justice.gov.uk)
* Contact the Technology Service Desk to report suspected malware – [MOJ.Servicedesk.uk@CGI.com](mailto:MOJ.Servicedesk.uk@CGI.com). Telephone: 0800 917 5148.
* Contact the Operational Security Team (OST) - [Operationalsecurityteam@justice.gov.uk](mailto:Operationalsecurityteam@justice.gov.uk)
